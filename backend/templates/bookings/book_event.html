{% extends "base.html" %}

{% block title %}Book: {{ event.title }} | EMS{% endblock %}

{% block extra_head %}
<style>
    .booking-layout {
        gap: 1.5rem;
    }
    .booking-summary-card,
    .booking-form-card {
        border-radius: 16px;
        border: none;
        box-shadow: 0 10px 20px rgba(0,0,0,0.06);
    }
    .booking-summary-card {
        background: linear-gradient(135deg, #6C63FF 0%, #00B4D8 100%);
        color: #fff;
    }
    .badge-event {
        padding: 6px 10px;
        border-radius: 8px;
        font-size: 0.75rem;
        font-weight: 600;
    }
    .badge-exhibition { background: #FFD166; color: #6A5300; }
    .badge-conference { background: #06D6A0; color: #004D3A; }
    .badge-concert    { background: #FF6B6B; color: #680000; }
    .badge-sports     { background: #4DABF7; color: #003E73; }
</style>
{% endblock %}

{% block content %}
<h1 class="mb-4" style="color:#6C63FF;">Book: {{ event.title }}</h1>

<div class="row booking-layout">
    <!-- Summary -->
    <div class="col-lg-4 mb-4">
        <div class="card booking-summary-card h-100">
            <div class="card-body">
                {% if event_type == "Exhibition" %}
                    <span class="badge-event badge-exhibition">Exhibition</span>
                {% elif event_type == "Conference" %}
                    <span class="badge-event badge-conference">Conference</span>
                {% elif event_type == "Concert" %}
                    <span class="badge-event badge-concert">Concert</span>
                {% elif event_type == "Sports Game" %}
                    <span class="badge-event badge-sports">Sports Game</span>
                {% endif %}

                <h5 class="mt-3 mb-2">{{ event.title }}</h5>
                <p class="mb-1"><strong>Venue:</strong> {{ event.venue.name }}</p>
                <p class="mb-1">
                    <strong>Starts:</strong>
                    {{ event.start_time|date:"M d, Y g:i A" }}
                </p>

                {% if remaining_capacity is not None %}
                    <p class="mb-1">
                        <strong>Remaining capacity:</strong> {{ remaining_capacity }}
                    </p>
                {% else %}
                    <p class="mb-1">
                        <strong>Capacity:</strong> Unlimited / not specified
                    </p>
                {% endif %}

                {% if is_paid_event %}
                    <p class="mb-0">
                        <strong>Price per ticket:</strong> ${{ event.ticket_price }}
                    </p>
                {% else %}
                    <p class="mb-0">
                        <strong>Ticket price:</strong> Free
                    </p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Form -->
    <div class="col-lg-8 mb-4">
        <div class="card booking-form-card">
            <div class="card-body">
                <h5 class="card-title mb-3">
                    {% if is_paid_event %}Booking & Payment{% else %}Booking Details{% endif %}
                </h5>

                <form method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit" class="btn btn-primary">
                        Confirm booking
                    </button>
                    <a href="{% url 'events:event_detail' event.event_id %}"
                       class="btn btn-outline-secondary ms-2">
                        Cancel
                    </a>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
